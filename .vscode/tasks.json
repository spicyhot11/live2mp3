{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "1. Conan Install (Debug)",
            "type": "shell",
            "command": "${config:brew.bin}/conan install . --build=missing -s build_type=Debug",
            "options": {
                "cwd": "${workspaceFolder}/backend"
            },
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "2. CMake Configure (Debug)",
            "type": "shell",
            "command": "${config:brew.bin}/cmake --preset conan-debug",
            "options": {
                "cwd": "${workspaceFolder}/backend"
            },
            "dependsOn": [
                "1. Conan Install (Debug)"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "3. Build Backend (Debug)",
            "type": "shell",
            "command": "${config:brew.bin}/cmake --build build/Debug --config Debug --parallel 4",
            "options": {
                "cwd": "${workspaceFolder}/backend"
            },
            "dependsOn": [
                "2. CMake Configure (Debug)"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "4. Setup Runtime Env",
            "type": "shell",
            "command": "cp -n backend/config.json bin/ 2>/dev/null || true && cp -n backend/user_config.toml bin/ 2>/dev/null || true && mkdir -p bin/logs",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "dependsOn": [
                "3. Build Backend (Debug)"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "Build & Setup (Debug)",
            "dependsOn": [
                "4. Setup Runtime Env"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "1. Conan Install (Release)",
            "type": "shell",
            "command": "conan install . --build=missing -s build_type=Release",
            "options": {
                "cwd": "${workspaceFolder}/backend"
            },
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "2. CMake Configure (Release)",
            "type": "shell",
            "command": "${config:brew.bin}/cmake --preset conan-release",
            "options": {
                "cwd": "${workspaceFolder}/backend"
            },
            "dependsOn": [
                "1. Conan Install (Release)"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "3. Build Backend (Release)",
            "type": "shell",
            "command": "${config:brew.bin}/cmake --build build/Release --config Release --parallel 4",
            "options": {
                "cwd": "${workspaceFolder}/backend"
            },
            "dependsOn": [
                "2. CMake Configure (Release)"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "Build & Setup (Release)",
            "dependsOn": [
                "3. Build Backend (Release)",
                "4. Setup Runtime Env"
            ],
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        },
        {
            "label": "Clean Build",
            "type": "shell",
            "command": "rm -rf build build_debug bin/live2mp3",
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "group": "build",
            "presentation": {
                "reveal": "always",
                "panel": "new"
            }
        }
    ]
}